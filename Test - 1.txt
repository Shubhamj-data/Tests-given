Q1. Find the highest paid employee in each department along with department name.
Ans: - 
select e.emp_id, e.emp_name, e.salary, d.dept_name from Employee e
join Department d on e.dept_id = d.dept_id
where e.salary = (select max(e2.salary) from Employee e2 where e2.dept_id = e.dept_id);

Q2. List employees who earn more than their manager’s salary.
Ans: -
select emp_id, emp_name, salary from Employee 
where salary > (select max(salary) from Employee where job_title = 'manager');

Q3. Show department(s) where the average salary of employees is greater than the overall company average salary.
Ans: - 
select d.dept_name, avg(e.salary) as dept_avg_salary from Employee e
join Department d on e.dept_id = d.dept_id
group by d.dept_name having avg(e.salary) > (select avg(salary) from Employee);

Q4. Find employees whose age is more than 30 and are working in the same city as their department’s location.
Ans: - 
select e.emp_id, e.emp_name, p.city, d.dept_name, d.location from employee e
join emp_personal_detail p on e.emp_id=p.emp_id
join department d on e.dept_id=d.dept_id
where timestampdiff(year, p.dob, curdate()) > 30 and p.city=d.location;

Q5. Display employees who are the only employee in their department (single employee department).
Ans: - 
select e.emp_id, e.emp_name, e.job_title, d.dept_name from Employee e
join Department d on e.dept_id = d.dept_id
where e.dept_id in (select dept_id from Employee group by dept_id having count(*) = 1);
Q6. Show employees with duplicate city entries in Emp_Personal_Detail table (i.e., more than one employee from the same city).
Ans: - 
select e.emp_id, e.emp_name, p.city from employee e
join emp_personal_detail p on e.emp_id=p.emp_id
where p.city in (select city from emp_personal_detail group by city having count(*) > 1);

Q7. Display employees with email IDs that do not follow proper format (use REGEXP to detect invalid emails).
Ans: - 
select e.emp_id, e.emp_name, p.email from employee e
join emp_personal_detail p on e.emp_id = p.emp_id
where p.email not like '%@%.%';

Q8. Find employees whose salary is within 10% of the highest salary in the company.
Ans: -
select e.emp_id, e.emp_name, e.salary from employee e
where e.salary >= (select max(salary) from employee) * 0.9;

Q9. List departments where all employees are Single (based on marital_status in Emp_Personal_Detail).
Ans: -
select d.dept_id, d.dept_name from department d
join employee e on d.dept_id = e.dept_id
join emp_personal_detail p on e.emp_id = p.emp_id
group by d.dept_id, d.dept_name
having count(case when p.marital_status = 'Single' then 1 end) = 0;

Q10. How to find the second highest salary in a table?
Ans: -
select salary from employee
order by salary desc limit 1 offset 1;

Q11. What is the difference between WHERE and HAVING clause?
Ans: - 
WHERE clause filters rows and is used for individual records 
HAVING clause filters groups used for group records

Q12. What are Aggregate functions in SQL? Explain with example.
Ans: - Aggregate functions used to perform calculations, 
examples: count(), sum(), avg(), min(), max().

Q13. Write a query to find duplicate records in a table.
Answer: - 
select emp_name, dept_id, count(*) from employee
group by emp_name, dept_id
having count(*) > 1;

Q14. Write a query to find employees who have the same salary as another employee.
Ans: - 
select emp_id, emp_name, salary from employee
where salary in (select salary from employee group by salary having count(*) > 1);

Q15. What is a Subquery? Difference between Correlated Subquery and Simple Subquery.
Ans: - 
Q16. List employees hired in year 2020 or later.
Ans: - 
select emp_id, emp_name, hire_date from employee
where hire_date >= '2020-01-01';

Q17. What is the difference between WHERE and HAVING clause?
Ans: - 
WHERE clause filters rows and is used for individual records 
HAVING clause filters groups used for group records

Q18. Explain Primary Key, Foreign Key, Unique Key differences?
Ans: - Primary key is a combination of Unique and Not Null Constraint. 
Foreign Key is used to take a reference from another table column, which could be a primary key.
A Unique key is used to insert a unique record in a specific column, and It should not repeat as previous records in the column

Q19. What is the difference between DELETE, TRUNCATE, and DROP?
Ans: - DELETE used to delete specific records, 
TRUNCATE is used to clear all records in the table, 
DROP is used to delete the complete table/user/view

Q20. Difference between INNER JOIN, LEFT JOIN, RIGHT JOIN, FULL JOIN with example?
Answer: - 
Inner Join is used to join columns as specified
Left Join is used to join columns on the left side of the table
Right join is used to join columns on the right side of the table
Full Join is used to combine completely all the columns as required 
 
